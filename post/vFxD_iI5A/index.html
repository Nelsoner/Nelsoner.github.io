
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>å‰ç«¯ä¼ æ¥çš„æ•°æ®æ ¡éªŒ | Gridea</title>
<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://Nelsoner.github.io/favicon.ico?v=1574329580327">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://Nelsoner.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://Nelsoner.github.io">
        <img class="avatar" src="https://Nelsoner.github.io/images/avatar.png?v=1574329580327" alt="" width="32px" height="32px">
      </a>
      <a href="https://Nelsoner.github.io">
        <h1 class="site-title">Gridea</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            å…³äº
          </a>
        
      
        
          <a href="/post/you-lian/" class="menu purple-link">
            å‹é“¾
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">å‰ç«¯ä¼ æ¥çš„æ•°æ®æ ¡éªŒ</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-11-20 10:30:51</span>
            
          </div>
          <div class="post-content">
            <p><strong>æœ€è¿‘å†™äº†å¥½å¤šçš„éç©ºæ ¡éªŒï¼Œå†™å¾—æƒ³åäº†ï¼Œæ‰€ä»¥åƒæ–¹ç™¾è®¡æƒ³åŠæ³•å·æ‡’â€¦â€¦ğŸŒğŸŒğŸŒğŸŒ</strong></p>
<!-- more -->
<h2 id="ä¸€-ä½¿ç”¨annotaion-jsr-303æ ‡å‡†çš„æ ¡éªŒ">ä¸€ã€ä½¿ç”¨Annotaion JSR-303æ ‡å‡†çš„æ ¡éªŒ</h2>
<p><strong>hibernate-validatorä¸­éƒ¨åˆ†æ³¨è§£è¿›è¡Œæè¿°</strong></p>
<table>
<thead>
<tr>
<th>@AssertTrue</th>
<th>ç”¨äºbooleanå­—æ®µï¼Œè¯¥å­—æ®µåªèƒ½ä¸ºtrue</th>
</tr>
</thead>
<tbody>
<tr>
<td>@AssertFalse</td>
<td>è¯¥å­—æ®µçš„å€¼åªèƒ½ä¸ºfalse</td>
</tr>
<tr>
<td>@CreditCardNumber</td>
<td>å¯¹ä¿¡ç”¨å¡å·è¿›è¡Œä¸€ä¸ªå¤§è‡´çš„éªŒè¯</td>
</tr>
<tr>
<td>@DecimalMax</td>
<td>åªèƒ½å°äºæˆ–ç­‰äºè¯¥å€¼</td>
</tr>
<tr>
<td>@DecimalMin</td>
<td>åªèƒ½å¤§äºæˆ–ç­‰äºè¯¥å€¼</td>
</tr>
<tr>
<td>@Digits(integer=,fraction=)</td>
<td>æ£€æŸ¥æ˜¯å¦æ˜¯ä¸€ç§æ•°å­—çš„æ•´æ•°ã€åˆ†æ•°,å°æ•°ä½æ•°çš„æ•°å­—</td>
</tr>
<tr>
<td>@Email</td>
<td>æ£€æŸ¥æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„emailåœ°å€</td>
</tr>
<tr>
<td>@Future</td>
<td>æ£€æŸ¥è¯¥å­—æ®µçš„æ—¥æœŸæ˜¯å¦æ˜¯å±äºå°†æ¥çš„æ—¥æœŸ</td>
</tr>
<tr>
<td>@Length(min=,max=)</td>
<td>æ£€æŸ¥æ‰€å±çš„å­—æ®µçš„é•¿åº¦æ˜¯å¦åœ¨minå’Œmaxä¹‹é—´,åªèƒ½ç”¨äºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>@Max</td>
<td>è¯¥å­—æ®µçš„å€¼åªèƒ½å°äºæˆ–ç­‰äºè¯¥å€¼</td>
</tr>
<tr>
<td>@Min</td>
<td>è¯¥å­—æ®µçš„å€¼åªèƒ½å¤§äºæˆ–ç­‰äºè¯¥å€¼</td>
</tr>
<tr>
<td>@NotNull</td>
<td>ä¸èƒ½ä¸ºnull</td>
</tr>
<tr>
<td>@NotBlank</td>
<td>ä¸èƒ½ä¸ºç©ºï¼Œæ£€æŸ¥æ—¶ä¼šå°†ç©ºæ ¼å¿½ç•¥</td>
</tr>
<tr>
<td>@NotEmpty</td>
<td>ä¸èƒ½ä¸ºç©ºï¼Œè¿™é‡Œçš„ç©ºæ˜¯æŒ‡ç©ºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>@Null</td>
<td>æ£€æŸ¥è¯¥å­—æ®µä¸ºç©º</td>
</tr>
<tr>
<td>@Past</td>
<td>æ£€æŸ¥è¯¥å­—æ®µçš„æ—¥æœŸæ˜¯åœ¨è¿‡å»</td>
</tr>
<tr>
<td>@Pattern(regex=,flag=)</td>
<td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td>
</tr>
<tr>
<td>@Range(min=,max=,message=)</td>
<td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…</td>
</tr>
<tr>
<td>@Size(min=, max=)</td>
<td>æ£€æŸ¥è¯¥å­—æ®µçš„sizeæ˜¯å¦åœ¨minå’Œmaxä¹‹é—´ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°ç»„ã€é›†åˆã€Mapç­‰</td>
</tr>
<tr>
<td>@URL(protocol=,host,port)</td>
<td>æ£€æŸ¥æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„URLï¼Œå¦‚æœæä¾›äº†protocolï¼Œhostç­‰ï¼Œåˆ™è¯¥URLè¿˜éœ€æ»¡è¶³æä¾›çš„æ¡ä»¶</td>
</tr>
<tr>
<td>@Valid</td>
<td>è¯¥æ³¨è§£ä¸»è¦ç”¨äºå­—æ®µä¸ºä¸€ä¸ªåŒ…å«å…¶ä»–å¯¹è±¡çš„é›†åˆæˆ–mapæˆ–æ•°ç»„çš„å­—æ®µï¼Œæˆ–è¯¥å­—æ®µç›´æ¥ä¸ºä¸€ä¸ªå…¶ä»–å¯¹è±¡çš„å¼•ç”¨ï¼Œè¿™æ ·åœ¨æ£€æŸ¥å½“å‰å¯¹è±¡çš„åŒæ—¶ä¹Ÿä¼šæ£€æŸ¥è¯¥å­—æ®µæ‰€å¼•ç”¨çš„å¯¹è±¡</td>
</tr>
</tbody>
</table>
<p><em>ä½†æ˜¯ä»…ä»…æ˜¯è¿™äº›æ ¡éªŒæ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„</em></p>
<h2 id="äºŒ-è‡ªå®šä¹‰æ³¨è§£å®ç°æ ¡éªŒ">äºŒã€è‡ªå®šä¹‰æ³¨è§£å®ç°æ ¡éªŒ</h2>
<p>Userç±»</p>
<pre><code class="language-java">@Data
public class User{

    //hibernate-validatoræ ¡éªŒ
    @NotEmpty(message = &quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;)
    private String username;

    //è‡ªå®šä¹‰éªŒè¯æ³¨è§£
    @MyPasswordConstraint(message = &quot;å¯†ç æ ¼å¼é”™è¯¯&quot;)
    private String password;

    private String nickname;

}
</code></pre>
<p>MyPasswordConstraintè‡ªå®šä¹‰æ³¨è§£</p>
<pre><code class="language-java">@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RUNTIME)
@Documented
@Constraint(validatedBy = {MyPasswordConstraint.PasswordValidatorString.class, MyPasswordConstraint.PasswordValidatorLong.class}) //è¿™é‡Œå¯ä»¥å†™å¤šä¸ª
public @interface MyPasswordConstraint {
    String message() default &quot;&quot;;

    Class&lt;?&gt;[] groups() default {};

    Class&lt;? extends Payload&gt;[] payload() default {};

    //ä¸ºäº†ä»£ç å¥½çœ‹ï¼Œå°±å†™ä¸ªå†…éƒ¨ç±»
    class PasswordValidatorString implements ConstraintValidator&lt;MyPasswordConstraint, String&gt; {

        //ç”±äºå®ç°äº†ConstraintValidatoræ¥å£ï¼Œ
        // å®ƒé»˜è®¤è¢«springç®¡ç†æˆbean,
        // å¯ä»¥ç”¨@Autowireduæˆ–è€…@Resourcesæ³¨å…¥åˆ«çš„æœåŠ¡ï¼Œ
        // è€Œä¸”ä¸ç”¨åœ¨ç±»ä¸Šé¢ç”¨@Compentæ³¨è§£æˆspringçš„bean

        //åˆå§‹åŒ–
        @Override
        public void initialize(MyPasswordConstraint constraintAnnotation) {

        }

        //æ ¡éªŒé€»è¾‘
        @Override
        public boolean isValid(String s, ConstraintValidatorContext constraintValidatorContext) {
            return false;
        }
    }

    class PasswordValidatorLong implements ConstraintValidator&lt;MyPasswordConstraint, Long&gt; {

        @Override
        public void initialize(MyPasswordConstraint constraintAnnotation) {

        }

        @Override
        public boolean isValid(Long aLong, ConstraintValidatorContext constraintValidatorContext) {
            return false;
        }

    }
}
</code></pre>
<p>UserController</p>
<pre><code class="language-java">@RestController
public class UserController {

    @RequestMapping(value = &quot;/user/add&quot;, method = RequestMethod.POST)
    public String addUser(@Valid @RequestBody User user, BindingResult bindingResult){
        if (bindingResult.hasErrors()) {
            List&lt;ObjectError&gt; allErrors = bindingResult.getAllErrors();
            FieldError error = (FieldError) allErrors.get(0);
            String message = error.getField() + &quot; &quot; + error.getDefaultMessage();
            return message;
        }
        System.out.println(user.getUsername());
        return user.getUsername();
    }
}
</code></pre>
<blockquote>
<p>è¿™é‡Œå¿…é¡»è¦è¯´ä¸€å“ˆï¼Œ(@Valid @RequestBody User user, BindingResult bindingResult)å‚æ•°åˆ—è¡¨ä¸­ï¼Œå¦‚æœbindingResultä¸åŠ ï¼Œæ•°æ®æ ¡éªŒä¸é€šè¿‡çš„è¯ï¼Œä¸ä¼šè¿›å…¥Controllerï¼›æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åŠ ä¸Šè¿™ä¸ªå‚æ•°ï¼Œå¯ä»¥æ ¹æ®æ ¡éªŒçš„ç»“æœå°è£…æˆç»Ÿä¸€çš„ã€æˆ‘ä»¬å¸Œæœ›çš„æ ¼å¼çš„ç»“æœè¿”å›ç»™äº²è¯·æ±‚ç«¯</p>
</blockquote>
<h2 id="ä¸‰-åŸºäºvalidatoræ¥å£çš„æ ¡éªŒ">ä¸‰ã€åŸºäºValidatoræ¥å£çš„æ ¡éªŒ</h2>
<p>UserTWOç±»</p>
<pre><code class="language-java">@Data
public class UserTWO {

    private String username;

    private String password;

    private String nickname;

}
</code></pre>
<p>UserValidatorç±»</p>
<pre><code class="language-java">public class UserValidator implements Validator {
    @Override
    public boolean supports(Class&lt;?&gt; aClass) {
        //åˆ¤æ–­æ˜¯å¦æ˜¯è¦æ ¡éªŒçš„ç±»,è¿™é‡Œæ˜¯User
        return UserTWO.class.equals(aClass);
    }

    @Override
    public void validate(Object o, Errors errors) {
        UserTWO u = (UserTWO) o;
        if (null == u.getPassword() || &quot;&quot;.equals(u.getPassword())) {
            //field, æ ¡éªŒä¿¡æ¯
            //errors.rejectValue(&quot;password&quot;, &quot;å¯†ç ä¸èƒ½ä¸ºç©º&quot;);
            errors.reject(&quot;password&quot;, &quot;å¯†ç ä¸èƒ½ä¸ºç©º&quot;);
        }
        //è¿™é‡Œå¯ä»¥å¯¹Userçš„åŸŸï¼ŒæŒ¨ä¸ªæ ¡éªŒ

    }
}
</code></pre>
<p>UserTWOControllerç±»</p>
<pre><code class="language-java">@RestController
public class UserTWOController {

    //åœ¨Controllerç±»ä¸­é€šè¿‡@InitBinderæ ‡è®°çš„æ–¹æ³•åªæœ‰åœ¨è¯·æ±‚å½“å‰Controllerçš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œ
    //æ³¨å†Œæ ¡éªŒå™¨
    @InitBinder
    public void initBainder(DataBinder binder){
        binder.replaceValidators(new UserValidator());
    }
    
    @RequestMapping(value = &quot;/userTwo/add&quot;, method = RequestMethod.POST)
    public String addUser(@Valid @RequestBody UserTWO user, BindingResult bindingResult){
        if (bindingResult.hasErrors()) {
            List&lt;ObjectError&gt; allErrors = bindingResult.getAllErrors();
            String message =  allErrors.get(0).getCode() + &quot; &quot; + allErrors.get(0).getDefaultMessage();
            return message;
        }
        System.out.println(user.getUsername());
        return user.getUsername();
    }
}

</code></pre>
<pre><code>åŸºäºValidatoræ¥å£çš„æ ¡éªŒï¼Œæ¯”è¾ƒniceï¼Œç›´æ¥ä¸€ä¸ªå®ä½“ç±»çš„æ ¡éªŒå…¨åšäº†
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://Nelsoner.github.io/post/hello-gridea">
              <h3 class="post-title">
                ä¸‹ä¸€ç¯‡ï¼šHello Gridea
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">æ¸©æ•…è€ŒçŸ¥æ–°</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<script>
 
!function(){
 
 function n(n,e,t){
 
 return n.getAttribute(e)||t
 
 }
 
 function e(n){
 
 return document.getElementsByTagName(n)
 
 }
 
 function t(){
 
 var t=e("script"),o=t.length,i=t[o-1];
 
 return{
 
 l:o,z:n(i,"zIndex",-1),o:n(i,"opacity",.5),c:n(i,"color","0,0,0"),n:n(i,"count",99)
 
 }
 
 }
 
 function o(){
 
 a=m.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,
 
 c=m.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight
 
 }
 
 function i(){
 
 r.clearRect(0,0,a,c);
 
 var n,e,t,o,m,l;
 
 s.forEach(function(i,x){
 
 for(i.x+=i.xa,i.y+=i.ya,i.xa*=i.x>a||i.x<0?-1:1,i.ya*=i.y>c||i.y<0?-1:1,r.fillRect(i.x-.5,i.y-.5,1,1),e=x+1;e<u.length;e++)n=u[e],
 
 null!==n.x&&null!==n.y&&(o=i.x-n.x,m=i.y-n.y,
 
 l=o*o+m*m,l<n.max&&(n===y&&l>=n.max/2&&(i.x-=.03*o,i.y-=.03*m),
 
 t=(n.max-l)/n.max,r.beginPath(),r.lineWidth=t/2,r.strokeStyle="rgba("+d.c+","+(t+.2)+")",r.moveTo(i.x,i.y),r.lineTo(n.x,n.y),r.stroke()))
 
 }),

 x(i)
 
 }
 
 var a,c,u,m=document.createElement("canvas"),
 
 d=t(),l="c_n"+d.l,r=m.getContext("2d"),
x=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
 
 function(n){

 window.setTimeout(n,1e3/45)
 
 },
 
 w=Math.random,y={x:null,y:null,max:2e4};m.id=l,m.style.cssText="position:fixed;top:0;left:0;z-index:"+d.z+";opacity:"+d.o,e("body")[0].appendChild(m),o(),window.onresize=o,
 
 window.onmousemove=function(n){
 
 n=n||window.event,y.x=n.clientX,y.y=n.clientY
 
 },
 
 window.onmouseout=function(){
 
 y.x=null,y.y=null
 
 };
 
 for(var s=[],f=0;d.n>f;f++){
 
 var h=w()*a,g=w()*c,v=2*w()-1,p=2*w()-1;s.push({x:h,y:g,xa:v,ya:p,max:6e3})
 
 }
 
 u=s.concat([y]),
 
 setTimeout(function(){i()},100)
 
 }();
 </script> | <a class="rss" href="https://Nelsoner.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '75a8bd3b4923acf89ed3',
        clientSecret: '02baf755a08bd0f954a1bfcc581fd6ea26806d07',
        repo: 'myblog',
        owner: 'myblog',
        admin: ['myblog'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
